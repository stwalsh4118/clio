# 1-4 Create config command with subcommands

[Back to task list](./tasks.md)

## Description

Implement the `clio config` command with subcommands for viewing and modifying configuration: `--show`, `--add-watch`, and `--set-blog-repo`. This allows users to interact with the configuration system via the CLI.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-11-14 01:41:47 | Created | N/A | Proposed | Task file created | System |

## Requirements

1. Create `clio config` command as a subcommand of root
2. Implement `clio config --show` to display current configuration in readable format
3. Implement `clio config --add-watch <path>` to add a directory to the watched directories list
4. Implement `clio config --set-blog-repo <path>` to set the blog repository path
5. Configuration changes must persist to the config file
6. Validate input paths (existence, permissions)
7. Provide helpful error messages for invalid inputs
8. Handle duplicate entries appropriately (for --add-watch)

## Implementation Plan

1. Create `internal/cli/config.go` for config command implementation
2. Register `config` command as subcommand of root command
3. Implement `--show` flag:
   - Load current configuration
   - Format and display configuration values
   - Show all settings in readable format (YAML or formatted text)
4. Implement `--add-watch` flag:
   - Accept path argument
   - Validate path exists and is a directory
   - Load current config
   - Add path to watched_directories if not already present
   - Save updated configuration to file
5. Implement `--set-blog-repo` flag:
   - Accept path argument
   - Validate path exists and is a directory (and optionally a git repo)
   - Load current config
   - Set blog_repository value
   - Save updated configuration to file
6. Create helper functions in `internal/config/` for:
   - Saving configuration to file
   - Validating paths
   - Checking for duplicate entries
7. Integrate with configuration loader from task 1-3

## Test Plan

**Objective**: Verify config command works correctly for viewing and modifying configuration.

**Test Scope**:
- Config command registration
- --show flag functionality
- --add-watch flag functionality
- --set-blog-repo flag functionality
- Configuration persistence
- Input validation

**Key Test Scenarios**:
1. `clio config --show` displays current configuration
2. `clio config --add-watch <valid-path>` adds path to config file
3. `clio config --add-watch <invalid-path>` shows helpful error message
4. `clio config --add-watch <duplicate-path>` handles duplicates appropriately
5. `clio config --set-blog-repo <valid-path>` updates blog repository path
6. `clio config --set-blog-repo <invalid-path>` shows helpful error message
7. Configuration changes persist after command execution
8. Configuration can be reloaded and shows updated values

**Success Criteria**:
- All config command flags work as specified
- Configuration changes persist to file
- Error messages are helpful and actionable
- Input validation prevents invalid configurations

## Verification

- [ ] `clio config --show` command exists and displays configuration
- [ ] `clio config --add-watch <path>` adds directory to watched list
- [ ] `clio config --set-blog-repo <path>` sets blog repository path
- [ ] Configuration changes persist to config file
- [ ] Invalid paths show helpful error messages
- [ ] Duplicate entries are handled appropriately
- [ ] All commands provide help text

## Files Modified

- `internal/cli/config.go` (new)
- `internal/config/saver.go` (new, for saving config)
- `internal/config/validator.go` (new, for path validation)
- `internal/cli/root.go` (updated to register config command)


