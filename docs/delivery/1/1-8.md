# 1-8 E2E CoS Test

[Back to task list](./tasks.md)

## Description

End-to-end testing to verify all 12 acceptance criteria from PBI 1 are met. This comprehensive test ensures the complete foundation and CLI framework works as specified in the PBI Conditions of Satisfaction.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-11-14 01:41:47 | Created | N/A | Proposed | Task file created | System |

## Requirements

Verify all 12 Conditions of Satisfaction from PBI 1:

1. Go project initializes successfully with proper module structure
2. CLI framework provides all base commands (start, stop, status, config)
3. Configuration file is created in `~/.clio/config.yaml` on first run
4. Configuration persists across application restarts
5. `clio config --show` displays current configuration
6. `clio config --add-watch` successfully adds directories to watch list
7. `clio config --set-blog-repo` successfully sets blog repository path
8. `clio start` creates background daemon process
9. `clio stop` gracefully stops daemon process
10. `clio status` accurately reports daemon state
11. All commands provide helpful error messages for invalid inputs
12. Configuration validation prevents invalid settings

## Implementation Plan

1. Create comprehensive end-to-end test suite in `test/e2e/` or `test/integration/`:
   - Test file: `test/e2e/pbi1_cos_test.go` or similar
2. Set up test environment:
   - Use temporary directory for config files during tests
   - Clean up after each test
   - Isolate tests from user's actual ~/.clio directory
3. Implement test cases for each CoS:
   - Test 1: Verify Go module structure and compilation
   - Test 2: Verify all CLI commands exist and are accessible
   - Test 3: Verify config file creation on first run
   - Test 4: Verify configuration persistence (write, restart, read)
   - Test 5: Verify `clio config --show` output
   - Test 6: Verify `clio config --add-watch` functionality
   - Test 7: Verify `clio config --set-blog-repo` functionality
   - Test 8: Verify `clio start` creates daemon and PID file
   - Test 9: Verify `clio stop` gracefully stops daemon
   - Test 10: Verify `clio status` reports correct state
   - Test 11: Verify error messages for invalid inputs
   - Test 12: Verify configuration validation prevents invalid settings
4. Create test helpers for:
   - Setting up temporary config directory
   - Executing CLI commands programmatically
   - Checking daemon state
   - Cleaning up test artifacts
5. Document test execution instructions

## Test Plan

**Objective**: Verify all 12 PBI acceptance criteria are met through comprehensive end-to-end testing.

**Test Scope**: 
- All 12 Conditions of Satisfaction
- Complete CLI workflow
- Configuration management
- Daemon lifecycle
- Error handling
- Validation

**Environment & Setup**:
- Use temporary directories for test isolation
- Mock or use test file system
- Ensure clean state between tests

**Key Test Scenarios**:

1. **CoS 1**: Verify Go project structure and compilation
2. **CoS 2**: Verify all base commands exist (start, stop, status, config)
3. **CoS 3**: Verify config file creation on first run
4. **CoS 4**: Verify configuration persistence across restarts
5. **CoS 5**: Verify `clio config --show` displays configuration
6. **CoS 6**: Verify `clio config --add-watch` adds directories
7. **CoS 7**: Verify `clio config --set-blog-repo` sets blog repo path
8. **CoS 8**: Verify `clio start` creates background daemon
9. **CoS 9**: Verify `clio stop` gracefully stops daemon
10. **CoS 10**: Verify `clio status` reports daemon state accurately
11. **CoS 11**: Verify helpful error messages for invalid inputs
12. **CoS 12**: Verify configuration validation prevents invalid settings

**Success Criteria**:
- All 12 test scenarios pass
- Tests are repeatable and isolated
- Test coverage verifies complete PBI functionality
- Tests can be run as part of CI/CD pipeline

## Verification

- [ ] Test suite created for E2E CoS testing
- [ ] All 12 acceptance criteria have corresponding test cases
- [ ] Tests use temporary directories for isolation
- [ ] Test 1: Go project structure verified
- [ ] Test 2: All CLI commands verified
- [ ] Test 3: Config file creation verified
- [ ] Test 4: Configuration persistence verified
- [ ] Test 5: `clio config --show` verified
- [ ] Test 6: `clio config --add-watch` verified
- [ ] Test 7: `clio config --set-blog-repo` verified
- [ ] Test 8: `clio start` daemon creation verified
- [ ] Test 9: `clio stop` graceful shutdown verified
- [ ] Test 10: `clio status` accuracy verified
- [ ] Test 11: Error messages verified
- [ ] Test 12: Configuration validation verified
- [ ] All tests pass successfully

## Files Modified

- `test/e2e/pbi1_cos_test.go` (new, or appropriate test file location)
- Test helper files as needed


